(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-work-orders-togetherOrder"],{"0177":function(e,t,i){var n=i("1543");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var a=i("4f06").default;a("7b2f63f8",n,!0,{sourceMap:!1,shadowMode:!1})},1543:function(e,t,i){var n=i("24fb");t=n(!1),t.push([e.i,'@charset "UTF-8";\n/**\n * uni-app内置的常用样式变量\n */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */uni-page-body[data-v-b854cdb8]{background:#fff}body.?%PAGE?%[data-v-b854cdb8]{background:#fff}.title[data-v-b854cdb8]{text-align:center;line-height:1.8;font-weight:700;font-size:%?34?%}.order-info .info-li[data-v-b854cdb8]{line-height:1.8;display:-webkit-box;display:-webkit-flex;display:flex;font-size:%?24?%}.order-info .info-li .tab[data-v-b854cdb8]{width:%?150?%;text-align:justify;text-align-last:justify;text-justify:distribute-all-lines}.order-info .info-li uni-text[data-v-b854cdb8]{width:%?100?%;-webkit-box-flex:1;-webkit-flex:1;flex:1;word-wrap:break-word}.question-box .question-text[data-v-b854cdb8]{text-indent:2em;font-size:%?24?%;line-height:1.8}.content[data-v-b854cdb8]{padding:%?24?%;box-sizing:border-box}.part[data-v-b854cdb8]{width:100%;background:#fff;height:100%;padding:%?30?%;box-sizing:border-box}.part-title[data-v-b854cdb8]{width:100%;text-align:center;padding:%?30?%;box-sizing:border-box;font-size:%?30?%;font-weight:700}.tag-view[data-v-b854cdb8]{padding:0 %?30?%;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:right;-webkit-justify-content:right;justify-content:right}.order-body[data-v-b854cdb8]{padding-bottom:%?100?%;overflow:hidden}.order-footer[data-v-b854cdb8]{position:fixed;bottom:0;left:0;width:100%;height:%?100?%;box-shadow:0 %?-2?% 36px %?1?% rgba(56,56,56,.1);background:#fff;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-wrap:nowrap;flex-wrap:nowrap;-webkit-box-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end;-webkit-box-align:center;-webkit-align-items:center;align-items:center;padding:%?20?%;box-sizing:border-box}.order-footer .button[data-v-b854cdb8]{margin-left:%?20?%}.order-li[data-v-b854cdb8]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-flex-wrap:nowrap;flex-wrap:nowrap;border-bottom:1px solid #ebeef5;padding:%?10?% 0 %?60?%;box-sizing:border-box;width:100%}.order-li .order-li-tab[data-v-b854cdb8]{min-width:%?160?%}.order-li .order-li-text[data-v-b854cdb8]{word-wrap:break-word;font-weight:700;font-size:%?26?%;-webkit-box-flex:1;-webkit-flex:1;flex:1;width:100px}.order-li .tel-box[data-v-b854cdb8]{-webkit-align-self:end;align-self:end}.order-table[data-v-b854cdb8]{width:100%;border:1px solid #fff;font-size:%?24?%}.order-table .table-tr[data-v-b854cdb8]{width:100%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-wrap:nowrap;flex-wrap:nowrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;border-bottom:1px solid #fff}.order-table .table-tr .table-th[data-v-b854cdb8]{width:%?80?%;-webkit-box-flex:1;-webkit-flex-grow:1;flex-grow:1;text-align:center;line-height:2;border-right:1px solid #fff;background:rgba(24,144,255,.3);color:#1890ff}.order-table .table-tr .table-td[data-v-b854cdb8]{width:%?80?%;-webkit-box-flex:1;-webkit-flex-grow:1;flex-grow:1;text-align:center;line-height:2;border-right:1px solid #fff;background:#f0f0f0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;-o-text-overflow:ellipsis}.order-table .table-tr[data-v-b854cdb8]:last-child{border-bottom:none}.order-table .table-tr .table-th[data-v-b854cdb8]:last-child, .order-table .table-tr .table-td[data-v-b854cdb8]:last-child{border-right:none}.submitBtn[data-v-b854cdb8]{padding:%?40?%;box-sizing:border-box}.page-footer[data-v-b854cdb8]{position:fixed;bottom:0;right:0;width:100%;padding:%?40?%;box-sizing:border-box}.part[data-v-b854cdb8]{height:%?700?%;position:relative}.select-btn[data-v-b854cdb8]{padding:%?40?%;box-sizing:border-box;position:absolute;width:100%;bottom:0;left:0}',""]),e.exports=t},2909:function(e,t,i){"use strict";i("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,n.default)(e)||(0,a.default)(e)||(0,r.default)(e)||(0,o.default)()};var n=s(i("6005")),a=s(i("db90")),r=s(i("06c5")),o=s(i("3427"));function s(e){return e&&e.__esModule?e:{default:e}}},3427:function(e,t,i){"use strict";i("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},i("d9e2"),i("d401")},3735:function(e,t,i){"use strict";i("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("c740"),i("a434"),i("4de4"),i("d3b7"),i("159b"),i("14d9"),i("e9c4"),i("a630"),i("3ca3"),i("6062"),i("ddb0");var n=i("db37"),a=i("a28a"),r=i("1be7"),o=(i("ffe9"),i("eff3"),i("69ef")),s=i("7c7e"),l=(i("15db"),{dicts:["itsm_fix_ok","itsm_fix_speed_level","sys_yes_no"],data:function(){return{engineersArray:[],engineerOptions:[],engineerData:{},inputValue_json:"",equOptions:[],itsm_fix_order_result:[],resultArray:[],fixType:[],level1:[],level2:[],level3:[],engineerRules:{empNo:{rules:[{required:!0,errorMessage:"請選擇工程師！"}]}},rules:{empNo:{rules:[{required:!0,errorMessage:"請選擇工程師！"}]}},formData:{},fixHead:{orderNo:"",empName:"",empNo:"",createDate:"",departmentName:"",telNo:"",repRemark:""}}},beforeMount:function(){this.getDictsOption()},onLoad:function(e){e.hasOwnProperty("orderNo")||(uni.showToast({icon:"error",title:"數據錯誤，請確認！",duration:2e3}),setTimeout((function(){uni.reLaunch({url:"/pages/index"})}),2e3)),this.orderNo=e.orderNo,this.getEquList(),this.getOrder()},methods:{removePart:function(e){var t=this;uni.showModal({title:"提示",content:"請確認刪除？",success:function(i){if(i.confirm){var n=t.engineersArray,a=n.findIndex((function(t){return t.partNo==e.partNo}));n.splice(a,1),t.engineersArray=n}else i.cancel}})},partSubmit:function(e){var t=this,i=this;this.$refs[e].validate().then((function(e){var n=i.engineerOptions.filter((function(e){return i.engineerData.empNo==e.empNo}));if(n.length>0){var a=i.engineersArray,r=!1;a.forEach((function(e){e.empNo==t.engineerData.empNo&&(r=!0)})),r||a.push(JSON.parse(JSON.stringify(t.engineerData))),t.engineersArray=a,i.$refs.popup.close("bottom")}else uni.showToast({title:"請選擇正確的工程師！",icon:"error"})})).catch((function(e){console.log("err",e)}))},partReset:function(){this.engineerData={}},selectEngineer:function(e){for(var t in e)this.engineerData[t]=e[t]},getEngineer:function(e){var t=this;""!==e?(0,a.selectAreaEngineers)(this.orderNo,e).then((function(e){e.forEach((function(e){e.id=e.empNo,e.name=e.empNo+"-"+e.empName})),t.engineerOptions=e})):this.engineerOptions=[]},inputEngineer:function(e){var t=e.split("-")[0];this.getEngineer(t)},open:function(){this.partReset(),this.$refs.popup.open("bottom")},submit:function(){var e=this;e.formData.orderNo=e.orderNo,e.formData.engineersArray=this.engineersArray;var t=[];if(this.engineersArray.forEach((function(e){t.push(e.empNo)})),t.length>0){var i={orderNo:e.orderNo,assistEmpNos:t.join(",")};(0,n.assistWorking)(i).then((function(t){uni.showToast({title:"已協同！"}),setTimeout((function(){uni.redirectTo({url:"/pages/work/orders/dealOrderInfo?orderNo="+e.orderNo})}),2e3)}))}else uni.showToast({title:"請選擇工程師！",icon:"error"})},getEquList:function(e){var t=this;""!==e?(0,s.likeno)(e).then((function(e){e.forEach((function(e){e.id=e.equNo,e.name=e.equNo})),t.equOptions=e})):this.equOptions=[]},inputEquNo:function(e){this.getEquList(e)},onnode2click:function(e){var t=e.value,i=[],n=this.fixType;n.forEach((function(e){e.level2==t&&i.push(e.level3)}));var a=[];i.forEach((function(e){var t={text:e,value:e};a.push(t)})),this.level3=a,this.formData.fixType3=null},onnodeclick:function(e){var t=e.value,i=this.fixType,n=[];i.forEach((function(e){e.level1==t&&n.push(e.level2)})),n=Array.from(new Set(n));var a=[];n.forEach((function(e){var t={text:e,value:e};a.push(t)})),this.level2=a,this.level3=[],this.formData.fixType2=null,this.formData.fixType3=null},getOrder:function(){var e=this;uni.showLoading({title:"加载中"}),(0,o.baseInfo)(this.orderNo).then((function(t){uni.hideLoading(),e.fixHead=t.data.orderInfo}))},getDictsOption:function(){var e=this;(0,r.getDicts)("itsm_fix_ok").then((function(t){var i=t.data;e.itsm_fix_ok=[],i.forEach((function(t){var i={text:t.dictLabel,value:t.dictValue};e.itsm_fix_ok.push(i)}))})),(0,r.getDicts)("itsm_fix_speed_level").then((function(t){var i=t.data;e.itsm_fix_speed_level=[],i.forEach((function(t){var i={text:t.dictLabel,value:t.dictValue};e.itsm_fix_speed_level.push(i)}))})),(0,r.getDicts)("sys_yes_no").then((function(t){var i=t.data;e.sys_yes_no=[],i.forEach((function(t){var i={text:t.dictLabel,value:t.dictValue};e.sys_yes_no.push(i)}))})),(0,r.getDicts)("itsm_fix_order_result").then((function(t){var i=t.data;e.itsm_fix_order_result=[],i.forEach((function(t){var i={text:t.dictLabel,value:t.dictValue};e.itsm_fix_order_result.push(i)}))}))}}});t.default=l},"38c7":function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return r})),i.d(t,"a",(function(){return n}));var n={uniSection:i("10b3").default,uniCard:i("1694").default,uniIcons:i("c758").default,uniPopup:i("4fa8").default,uniForms:i("01bb").default,uniFormsItem:i("ea92").default,superweiCombox:i("be99").default},a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",{staticClass:"questionaire"},[i("uni-section",{attrs:{title:"報修信息",type:"line"}},[i("uni-card",{staticClass:"order-info"},[i("v-uni-view",{staticClass:"info-li"},[i("v-uni-view",{staticClass:"tab"},[e._v("報修單號：")]),i("v-uni-text",[e._v(e._s(e.fixHead.orderNo))])],1),i("v-uni-view",{staticClass:"info-li"},[i("v-uni-view",{staticClass:"tab"},[e._v("報修人：")]),i("v-uni-text",[e._v(e._s(e.fixHead.empNo)+"-"+e._s(e.fixHead.empName))])],1),i("v-uni-view",{staticClass:"info-li"},[i("v-uni-view",{staticClass:"tab"},[e._v("報修時間：")]),i("v-uni-text",[e._v(e._s(e.fixHead.createDate))])],1),i("v-uni-view",{staticClass:"info-li"},[i("v-uni-view",{staticClass:"tab"},[e._v("所在單位：")]),i("v-uni-text",[e._v(e._s(e.fixHead.departmentName))])],1),i("v-uni-view",{staticClass:"info-li"},[i("v-uni-view",{staticClass:"tab"},[e._v("聯繫方式：")]),i("v-uni-text",[e._v(e._s(e.fixHead.telNo))])],1),i("v-uni-view",{staticClass:"info-li"},[i("v-uni-view",{staticClass:"tab"},[e._v("報修內容：")]),i("v-uni-text",[e._v(e._s("【"+e.fixHead.repTypeLevel1+"-"+e.fixHead.repTypeLevel2+"】"+e.fixHead.repRemark+"（數量"+e.fixHead.repNum+"）"))])],1)],1)],1),i("uni-section",{attrs:{title:"工程師選擇",type:"line"}},[i("v-uni-view",{staticClass:"tag-view"},[i("uni-icons",{attrs:{type:"plusempty",size:"30",color:"#007aff"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.open.apply(void 0,arguments)}}})],1),e.engineersArray.length>0?i("v-uni-view",{staticClass:"order-li"},[i("v-uni-view",{staticClass:"order-table"},[i("v-uni-view",{staticClass:"table-tr"},[i("v-uni-view",{staticClass:"table-th"},[e._v("工號")]),i("v-uni-view",{staticClass:"table-th"},[e._v("姓名")]),i("v-uni-view",{staticClass:"table-th"},[e._v("操作")])],1),e._l(e.engineersArray,(function(t,n){return i("v-uni-view",{staticClass:"table-tr"},[i("v-uni-view",{staticClass:"table-td"},[e._v(e._s(t.empNo))]),i("v-uni-view",{staticClass:"table-td"},[e._v(e._s(t.empName))]),i("v-uni-view",{staticClass:"table-td"},[i("uni-icons",{attrs:{type:"closeempty",size:"12",color:"#f00"},on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.removePart(t)}}})],1)],1)}))],2)],1):e._e()],1),i("v-uni-view",{staticClass:"page-footer"},[i("v-uni-button",{attrs:{type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.submit()}}},[e._v("提交")])],1),i("uni-popup",{ref:"popup",attrs:{type:"bottom"}},[i("v-uni-view",{staticClass:"part"},[i("v-uni-view",{staticClass:"part-title"},[e._v("選擇工程師")]),i("uni-forms",{ref:"partForm",attrs:{rules:e.engineerRules,modelValue:e.engineerData}},[i("uni-forms-item",{attrs:{required:!0,label:"工程師",name:"empNo"}},[i("superwei-combox",{attrs:{candidates:e.engineerOptions,isJSON:!0,keyName:"name",valueName:"empNo",placeholder:"请选择工程師"},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.inputEngineer.apply(void 0,arguments)},select:function(t){arguments[0]=t=e.$handleEvent(t),e.selectEngineer.apply(void 0,arguments)}},model:{value:e.engineerData.empNo,callback:function(t){e.$set(e.engineerData,"empNo",t)},expression:"engineerData.empNo"}})],1),i("v-uni-view",{staticClass:"select-btn"},[i("v-uni-button",{attrs:{type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.partSubmit("partForm")}}},[e._v("確定")])],1)],1)],1)],1)],1)},r=[]},6005:function(e,t,i){"use strict";i("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(Array.isArray(e))return(0,n.default)(e)};var n=function(e){return e&&e.__esModule?e:{default:e}}(i("6b75"))},aa0e:function(e,t,i){"use strict";i.r(t);var n=i("38c7"),a=i("bebb");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("e8fd");var o=i("f0c5"),s=Object(o["a"])(a["default"],n["b"],n["c"],!1,null,"b854cdb8",null,!1,n["a"],void 0);t["default"]=s.exports},bebb:function(e,t,i){"use strict";i.r(t);var n=i("3735"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t["default"]=a.a},db90:function(e,t,i){"use strict";i("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},i("a4d3"),i("e01a"),i("d3b7"),i("d28b"),i("3ca3"),i("ddb0"),i("a630")},e8fd:function(e,t,i){"use strict";var n=i("0177"),a=i.n(n);a.a}}]);